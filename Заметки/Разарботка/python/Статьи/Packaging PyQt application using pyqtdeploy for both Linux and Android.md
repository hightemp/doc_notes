https://medium.com/@Lola_Dam/packaging-pyqt-application-using-pyqtdeploy-for-both-linux-and-android-32ac7824708b

This article is a guide on building the _pyqt-demo_ application for both Linux and Android using [_pyqtdeploy_](https://www.riverbankcomputing.com/software/pyqtdeploy/intro) tool.

> It should also be possible to build Android applications on Windows and Linux but this isn’t tested. — Pyqt-demo README

# Prerequisite

_It is assume that you have already installed python 3 and pip for this part._

Pyqtdeploy is on pip so we can easily install it :

$ pip install pyqtdeploy

Now we need the `pyqt-demo` code source. You can find it on the pip website. Download the source code and extract the demo folder : [https://pypi.org/project/pyqtdeploy/#files](https://pypi.org/project/pyqtdeploy/#files)

You should have the following structures :

.  
├── build-demo.py  
├── data  
│   └── __init__.py  
├── pyqt-demo.pdy  
├── pyqt-demo.py  
├── README  
└── sysroot.json1 directory, 6 files

Now if we open `sysroot.json` we will find that we need to download some libraries for our app and it might differ from platforms to platform. Like you might need `openssl-1.0.2r.tar.gz` for android.

In order to speed up the process and not have to manually download everything. We can use this small script to download everything at once.

_download.sh_

wget [https://www.zlib.net/fossils/zlib-1.2.11.tar.gz](https://www.zlib.net/fossils/zlib-1.2.11.tar.gz)  
wget [http://download.qt.io/official_releases/qt/5.12/5.12.2/single/qt-everywhere-src-5.12.2.tar.xz](http://download.qt.io/official_releases/qt/5.12/5.12.2/single/qt-everywhere-src-5.12.2.tar.xz)  
wget [https://www.python.org/ftp/python/3.7.2/Python-3.7.2.tar.xz](https://www.python.org/ftp/python/3.7.2/Python-3.7.2.tar.xz)  
wget [https://www.riverbankcomputing.com/static/Downloads/sip/4.19.15/sip-4.19.15.tar.gz](https://www.riverbankcomputing.com/static/Downloads/sip/4.19.15/sip-4.19.15.tar.gz)  
wget [https://www.riverbankcomputing.com/static/Downloads/PyQt5/5.12.1/PyQt5_gpl-5.12.1.tar.gz](https://www.riverbankcomputing.com/static/Downloads/PyQt5/5.12.1/PyQt5_gpl-5.12.1.tar.gz)  
wget [https://www.riverbankcomputing.com/static/Downloads/PyQt3D/5.12/PyQt3D_gpl-5.12.tar.gz](https://www.riverbankcomputing.com/static/Downloads/PyQt3D/5.12/PyQt3D_gpl-5.12.tar.gz)  
wget [https://www.riverbankcomputing.com/static/Downloads/PyQtChart/5.12/PyQtChart_gpl-5.12.tar.gz](https://www.riverbankcomputing.com/static/Downloads/PyQtChart/5.12/PyQtChart_gpl-5.12.tar.gz)  
wget [https://www.riverbankcomputing.com/static/Downloads/PyQtDataVisualization/5.12/PyQtDataVisualization_gpl-5.12.tar.gz](https://www.riverbankcomputing.com/static/Downloads/PyQtDataVisualization/5.12/PyQtDataVisualization_gpl-5.12.tar.gz)  
wget [https://www.riverbankcomputing.com/static/Downloads/PyQtPurchasing/5.12/PyQtPurchasing_gpl-5.12.tar.gz](https://www.riverbankcomputing.com/static/Downloads/PyQtPurchasing/5.12/PyQtPurchasing_gpl-5.12.tar.gz)  
wget [https://www.riverbankcomputing.com/static/Downloads/QScintilla/2.11.1/QScintilla_gpl-2.11.1.tar.gz](https://www.riverbankcomputing.com/static/Downloads/QScintilla/2.11.1/QScintilla_gpl-2.11.1.tar.gz)  
wget [https://ftp.openssl.org/source/old/1.0.2/openssl-1.0.2r.tar.gz](https://ftp.openssl.org/source/old/1.0.2/openssl-1.0.2r.tar.gz)

**Notes**: Remember this is for Linux and Android. If you are using another platform you might want to verify the `sysroot.json` file for `openssl` version.

# Linux

We have basically everything needed to start building our demo app for Linux. It doesn’t get more complicated than that.

$ python build-demo.py --verbose

Using the `--verbose` option will show the details of the build. It is not required but can help with understanding what is happening. The build will take time because it will build `Qt 5.12.2` from source for us.

We notice also in the `sysroot.json` that we can specify which modules to build and which to skip. It can really help to speed up the build time. You also obviously don’t need to rebuild it every time. Looking a bit more closely in the `build-demo.py` file we realize that it execute several steps :

-   `pyqtdeploy-sysroot`
-   `pyqtdeploy-build`
-   `qmake`
-   `make` or `nmake` for windows

Another file we can take a look at is the `pyqt-demo.pdy` which is used in step 2. This file is actually auto generated by `pyqtdeploy` .

$ pyqtdeploy pyqt-demo.pdy

![](https://miro.medium.com/v2/resize:fit:700/1*oZwrWD3WxLAPDcAPjDFsQQ.png)

pyqtdeploy GUI tool

This tool will generate a `.pdy` for you and help you include all the files needed for your application. You can find more details in the [official documentation](https://www.riverbankcomputing.com/static/Docs/pyqtdeploy/pyqtdeploy.html). For now, we don’t need to modify this as we already have our project file.

We have reviewed the basic components of a `pyqtdeploy` project. I recommend you keep exploring the 3 files we mentioned to understand a little bit more the structure.

# Android

Building for Android might be a little bit more tricky and requires extra tools and libraries. The official documentation lacks a bit of information on this. This section will try to complete the official tutorial in particular for people who might have never done Android development like me.

## Android Studio

First step would be to install [Android Studio](https://developer.android.com/studio). We don’t need the full IDE for android development but it will install all the tools we want and offer an easy to use interface to download the libraries needed. Also you will have an emulator installed for testing your `.apk` package in case you don’t have an android device on which to test your app.

## Installing Android SDK

I have a device (tablet Nexus 9) running Android Nougat (7.1.1) so I am going to build for it.

Open Android Studio and click on **Configure** ->**Settings**

![](https://miro.medium.com/v2/resize:fit:700/1*kofWBGKe6ehbHKcdjv8yKw.png)

Welcome to Android Studio window

Now choose **Android 7.0 (Nougat).**

![](https://miro.medium.com/v2/resize:fit:700/1*cyGGvCraJYevMraXHw3snw.png)

Android Studio Settings windows

Click on **Apply** to install the SDK.

_Note : Why didn’t I choose Android 7.1.1 (Nougat)? Unfortunately, I attempt to use it but always got an error message saying that my NDK wasn’t compatible with this version and that for several NDK version…_

## Installing our Android NDK

Because we are using **Qt 5.12.2** we need **Android NDK 19c** version. For some unknown reason the latest is not compatible.

You can download it from here : [https://developer.android.com/ndk/downloads/older_releases.html](https://developer.android.com/ndk/downloads/older_releases.html)

You can extract it in your `Android` folder which should have been created in your user space and already has your `Sdk` folder with the Android SDK with downloaded previously. You can create an `~/Android/Ndk` folder.

lola@*******:~/Android/Ndk$ tree -L 1  
.  
├── android-ndk-r19c  
└── android-ndk-r20

## Downloading Qt 5.12.2

When building for Android, we are not going to build Qt 5.12 from source. Instead you will need to download it : [https://www.qt.io/download](https://www.qt.io/download)

You can install it in your user folder under (e.g `~/Qt/` ). Be sure to remember the path we will need it.

Now be sure you have a folder named `android_armv7` . It is the folder name specify in the `sysroot.json` for Android target. In our case, it should be here `~/Qt/5.12.2/android_armv7` .

## Building the pyqt-demo .apk

We have all the libraries needed to build the Android app.

$ ANDROID_NDK_ROOT=$HOME/Android/NDK/android-ndk-r19c ANDROID_NDK_PLATFORM=android-24 ANDROID_SDK_ROOT=$HOME/Android/Sdk python3 build-demo.py --verbose --target android --installed-qt-dir $HOME/Qt/5.12.2/

This little guide summarize the all process to create the PyQt demo application. One of the advantage of using PyQt is to be able to build for multiple platform app and unlike the more famous Electron it doesn’t ship an entire browser with it.