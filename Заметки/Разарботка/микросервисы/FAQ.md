## что такое Stateful сервис

Stateful сервис - это сервис, который имеет состояние (state) и сохраняет его между запросами. Это отличается от Stateless сервиса, который не хранит состояния между запросами и обрабатывает каждый запрос отдельно.

Примером Stateful сервиса может быть онлайн-чат, который хранит состояние сеанса чата между пользователями и сохраняет его, чтобы пользователи могли продолжить общение после перезагрузки страницы или выхода из системы.

Такие сервисы могут быть более мощными, но их реализация может быть более сложной и требует хранения информации о пользователе в памяти или в базе данных. Кроме того, Stateful сервисы требуют обработки запросов сессии и управления состоянием между запросами, что также может влиять на производительность и сложность разработки.

## напиши пример stateless сервиса

Примером Stateless сервиса может быть служба, которая генерирует случайные числа и возвращает их в ответ на запрос. Такой сервис не хранит состояние между запросами и обрабатывает каждый запрос независимо от предыдущих запросов.

## напиши список патернов для микросервисов 

Ниже перечислены некоторые паттерны для микросервисной архитектуры:

1. API Gateway - предоставляет единый точку входа для внешних клиентов и обрабатывает запросы согласно правилам маршрутизации
2. Service Registry - хранит информацию о микросервисах, их доступности и положении в сети
3. Service Mesh - управляет сетью микросервисов и организует взаимодействия между ними с помощью боковых автоматических инъекций или proxy
4. Circuit Breaker - предотвращает ненужную нагрузку на микросервис, открывая “короткое замыкание” при перегрузке сервиса и предотвращая дальнейшие запросы
5. Saga Pattern - координирует выполнение транзакций между несколькими микросервисами и обеспечивает откат в случае ошибок
6. Sidecar - шаблон, при котором каждый микросервис имеет свой “прицепленный” контейнер. Например, для обработки запросов к базе данных.
7. Event-Driven Architecture - использует асинхронную связь через асинхронные события для уменьшения связности между микросервисами.
8. Обнаружение событий - уведомления микросервисов о событиях, что позволяет сервисам реагировать на эти события.
9. Command Query Responsibility Segregation (CQRS) Команда и запрос - паттерн, при котором каждый сервис имеет разделение на запросы и команды. Запросы - это запросы данных, а команды - это запросы на изменение данных.
10. Ограничение времени жизни (Time-to-live) - ограничивает временную жизнь объекта в системе. ApplicationDbContext позволит вам экономить ресурсы и уменьшать кол-во логических ошибок.
11. Группирующая служба (Aggregator) - выбирает данные из разных источников и предоставляет собранные данные в едином виде
12. Проверка работоспособности (Health Check) - проверяет состояние сервиса и обеспечивает автоматическое восстановление по его состоянию
13. Референсные данные (Reference data) - хранит общие данные, доступные для всех сервисов, такие как местоположения, валютные курсы и т. д.
14. Хранилище логов (Log Aggregation) - организует сбор и агрегацию журналов в централизованном месте для удобного их анализа и обработки.
15. Rate Limiting - ограничивает количество запросов к определенному сервису в единицу времени.

Выбор паттернов зависит от специфики проекта и целей микросервисной архитектуры.

## сколько всего патернов для микросервисов известно?

Количество паттернов для микросервисов не установлено и постоянно меняется, так как новые паттерны могут быть созданы, а существующие могут быть модифицированы или улучшены. Кроме того, использование каждого паттерна зависит от конкретных потребностей проекта и необязательно для всех проектов потребуется использование большого количества паттернов.

Однако, существуют списки с рекомендуемыми паттернами для микросервисов в зависимости от различных задач, которые могут быть решены с помощью микросервисной архитектуры. Некоторые из таких списков могут содержать до 20-30 паттернов, а более общие списки могут содержать около 10-15 паттернов.

Более важно знать, что микросервисная архитектура, как и любая другая архитектура, должна быть проектирована и разработана с учетом специфики проекта. Использование паттернов является лишь одним из инструментов для реализации микросервисов, и следует использовать эти инструменты, только если они соответствуют потребностям и требованиям проекта.

## опиши Saga Pattern (микросервисы)

Saga Pattern - это паттерн для управления транзакционной целостностью в распределенных системах микросервисов. Он используется для управления несколькими транзакциями между микросервисами, где каждый микросервис выполняет свою часть транзакции, и если одна часть не удалась, все остальные будут отменены.

В Saga Pattern каждый микросервис выполняет свою частную транзакцию, а затем отправляет сообщение следующему микросервису для выполнения своей транзакции. Если одна из транзакций не выполнится успешно, то есть ошибка, вся транзакция должна быть отменена.

Вот пример простого Saga Pattern:

- Шаг 1: Микросервис A отправляет запрос на создание заказа
- Шаг 2: Микросервис B получает запрос на создание заказа и резервирует необходимые товары на складе
- Шаг 3: Микросервис B отправляет подтверждение об успешном создании заказа и резервировании товаров микросервису A
- Шаг 4: Если микросервис B не может зарезервировать товары, он отправляет сообщение об ошибке микросервису A для отмены создания заказа.

Следует отметить, что каждый микросервис является автономным и может появляться дополнительный микросервис, когда система растет. Поэтому использование Saga Pattern может помочь обеспечить транзакционную целостность в такой распределенной системе.