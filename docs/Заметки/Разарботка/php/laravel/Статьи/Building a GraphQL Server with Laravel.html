<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Obsidian notes</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="Obsidian notes">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/doc_notes/assets/css/0.styles.60b82a90.css" as="style"><link rel="preload" href="/doc_notes/assets/js/app.d7b7570d.js" as="script"><link rel="preload" href="/doc_notes/assets/js/2.733019b2.js" as="script"><link rel="preload" href="/doc_notes/assets/js/230.043a91e9.js" as="script"><link rel="prefetch" href="/doc_notes/assets/js/10.466a3961.js"><link rel="prefetch" href="/doc_notes/assets/js/100.eed12daa.js"><link rel="prefetch" href="/doc_notes/assets/js/101.c2c72797.js"><link rel="prefetch" href="/doc_notes/assets/js/102.3a5b3674.js"><link rel="prefetch" href="/doc_notes/assets/js/103.4df54047.js"><link rel="prefetch" href="/doc_notes/assets/js/104.4e3d031e.js"><link rel="prefetch" href="/doc_notes/assets/js/105.fb56ad64.js"><link rel="prefetch" href="/doc_notes/assets/js/106.4cd1492c.js"><link rel="prefetch" href="/doc_notes/assets/js/107.a916259a.js"><link rel="prefetch" href="/doc_notes/assets/js/108.dfbcdb35.js"><link rel="prefetch" href="/doc_notes/assets/js/109.b85d5957.js"><link rel="prefetch" href="/doc_notes/assets/js/11.70fc3590.js"><link rel="prefetch" href="/doc_notes/assets/js/110.dc40183f.js"><link rel="prefetch" href="/doc_notes/assets/js/111.a9f83101.js"><link rel="prefetch" href="/doc_notes/assets/js/112.1b402c16.js"><link rel="prefetch" href="/doc_notes/assets/js/113.89928947.js"><link rel="prefetch" href="/doc_notes/assets/js/114.8be0db96.js"><link rel="prefetch" href="/doc_notes/assets/js/115.bd9e24bd.js"><link rel="prefetch" href="/doc_notes/assets/js/116.1979db39.js"><link rel="prefetch" href="/doc_notes/assets/js/117.7a439523.js"><link rel="prefetch" href="/doc_notes/assets/js/118.680aed03.js"><link rel="prefetch" href="/doc_notes/assets/js/119.dfdba03a.js"><link rel="prefetch" href="/doc_notes/assets/js/12.0f945969.js"><link rel="prefetch" href="/doc_notes/assets/js/120.37c405a9.js"><link rel="prefetch" href="/doc_notes/assets/js/121.672a368b.js"><link rel="prefetch" href="/doc_notes/assets/js/122.f1b5fad1.js"><link rel="prefetch" href="/doc_notes/assets/js/123.b0d4c3db.js"><link rel="prefetch" href="/doc_notes/assets/js/124.7f08733e.js"><link rel="prefetch" href="/doc_notes/assets/js/125.619db48f.js"><link rel="prefetch" href="/doc_notes/assets/js/126.048ed0c7.js"><link rel="prefetch" href="/doc_notes/assets/js/127.cc65fb73.js"><link rel="prefetch" href="/doc_notes/assets/js/128.27591c7f.js"><link rel="prefetch" href="/doc_notes/assets/js/129.e848d5ea.js"><link rel="prefetch" href="/doc_notes/assets/js/13.353aee93.js"><link rel="prefetch" href="/doc_notes/assets/js/130.0b6325e2.js"><link rel="prefetch" href="/doc_notes/assets/js/131.a4a8dc74.js"><link rel="prefetch" href="/doc_notes/assets/js/132.f78488ea.js"><link rel="prefetch" href="/doc_notes/assets/js/133.2c57ab36.js"><link rel="prefetch" href="/doc_notes/assets/js/134.c041a644.js"><link rel="prefetch" href="/doc_notes/assets/js/135.dd89210d.js"><link rel="prefetch" href="/doc_notes/assets/js/136.127b0247.js"><link rel="prefetch" href="/doc_notes/assets/js/137.1ff783eb.js"><link rel="prefetch" href="/doc_notes/assets/js/138.e72eaf60.js"><link rel="prefetch" href="/doc_notes/assets/js/139.135c74d8.js"><link rel="prefetch" href="/doc_notes/assets/js/14.a3283f94.js"><link rel="prefetch" href="/doc_notes/assets/js/140.4a7f191d.js"><link rel="prefetch" href="/doc_notes/assets/js/141.fa563aa9.js"><link rel="prefetch" href="/doc_notes/assets/js/142.266c8a69.js"><link rel="prefetch" href="/doc_notes/assets/js/143.3c3e596e.js"><link rel="prefetch" href="/doc_notes/assets/js/144.46a5cdc6.js"><link rel="prefetch" href="/doc_notes/assets/js/145.c33d2f51.js"><link rel="prefetch" href="/doc_notes/assets/js/146.ecf9ffa3.js"><link rel="prefetch" href="/doc_notes/assets/js/147.ecc8f162.js"><link rel="prefetch" href="/doc_notes/assets/js/148.57a0cc2c.js"><link rel="prefetch" href="/doc_notes/assets/js/149.243334a6.js"><link rel="prefetch" href="/doc_notes/assets/js/15.c66e3407.js"><link rel="prefetch" href="/doc_notes/assets/js/150.6811595e.js"><link rel="prefetch" href="/doc_notes/assets/js/151.a1b33f48.js"><link rel="prefetch" href="/doc_notes/assets/js/152.754c44e2.js"><link rel="prefetch" href="/doc_notes/assets/js/153.b6b30dd0.js"><link rel="prefetch" href="/doc_notes/assets/js/154.78d410b8.js"><link rel="prefetch" href="/doc_notes/assets/js/155.767f3fb1.js"><link rel="prefetch" href="/doc_notes/assets/js/156.f9095760.js"><link rel="prefetch" href="/doc_notes/assets/js/157.c538a726.js"><link rel="prefetch" href="/doc_notes/assets/js/158.9835a2a3.js"><link rel="prefetch" href="/doc_notes/assets/js/159.9d7c5a05.js"><link rel="prefetch" href="/doc_notes/assets/js/16.e7ecc933.js"><link rel="prefetch" href="/doc_notes/assets/js/160.addf636e.js"><link rel="prefetch" href="/doc_notes/assets/js/161.b9499ae3.js"><link rel="prefetch" href="/doc_notes/assets/js/162.9ebe738a.js"><link rel="prefetch" href="/doc_notes/assets/js/163.4860d1e7.js"><link rel="prefetch" href="/doc_notes/assets/js/164.148cebf3.js"><link rel="prefetch" href="/doc_notes/assets/js/165.41046f67.js"><link rel="prefetch" href="/doc_notes/assets/js/166.6deaed29.js"><link rel="prefetch" href="/doc_notes/assets/js/167.6d02a205.js"><link rel="prefetch" href="/doc_notes/assets/js/168.c86d38a7.js"><link rel="prefetch" href="/doc_notes/assets/js/169.eb313225.js"><link rel="prefetch" href="/doc_notes/assets/js/17.65a71bb5.js"><link rel="prefetch" href="/doc_notes/assets/js/170.889855cd.js"><link rel="prefetch" href="/doc_notes/assets/js/171.b95cf306.js"><link rel="prefetch" href="/doc_notes/assets/js/172.0b1e5fe3.js"><link rel="prefetch" href="/doc_notes/assets/js/173.99679181.js"><link rel="prefetch" href="/doc_notes/assets/js/174.f28ad52f.js"><link rel="prefetch" href="/doc_notes/assets/js/175.1c1f371e.js"><link rel="prefetch" href="/doc_notes/assets/js/176.662a9d28.js"><link rel="prefetch" href="/doc_notes/assets/js/177.6e464bd5.js"><link rel="prefetch" href="/doc_notes/assets/js/178.102c88e4.js"><link rel="prefetch" href="/doc_notes/assets/js/179.dddab088.js"><link rel="prefetch" href="/doc_notes/assets/js/18.8fedcbac.js"><link rel="prefetch" href="/doc_notes/assets/js/180.345e741e.js"><link rel="prefetch" href="/doc_notes/assets/js/181.59db7110.js"><link rel="prefetch" href="/doc_notes/assets/js/182.7f628252.js"><link rel="prefetch" href="/doc_notes/assets/js/183.e8653839.js"><link rel="prefetch" href="/doc_notes/assets/js/184.3eec36ec.js"><link rel="prefetch" href="/doc_notes/assets/js/185.cb0c13d5.js"><link rel="prefetch" href="/doc_notes/assets/js/186.1ccbe1a2.js"><link rel="prefetch" href="/doc_notes/assets/js/187.55e6bc99.js"><link rel="prefetch" href="/doc_notes/assets/js/188.1829998b.js"><link rel="prefetch" href="/doc_notes/assets/js/189.e86e8099.js"><link rel="prefetch" href="/doc_notes/assets/js/19.8fd4f833.js"><link rel="prefetch" href="/doc_notes/assets/js/190.3263ca68.js"><link rel="prefetch" href="/doc_notes/assets/js/191.6973d93a.js"><link rel="prefetch" href="/doc_notes/assets/js/192.8c648d4c.js"><link rel="prefetch" href="/doc_notes/assets/js/193.135dc6c4.js"><link rel="prefetch" href="/doc_notes/assets/js/194.2387809d.js"><link rel="prefetch" href="/doc_notes/assets/js/195.4e094a48.js"><link rel="prefetch" href="/doc_notes/assets/js/196.faae151e.js"><link rel="prefetch" href="/doc_notes/assets/js/197.6ca84b2f.js"><link rel="prefetch" href="/doc_notes/assets/js/198.99d5a7c7.js"><link rel="prefetch" href="/doc_notes/assets/js/199.5ac6f260.js"><link rel="prefetch" href="/doc_notes/assets/js/20.b7871733.js"><link rel="prefetch" href="/doc_notes/assets/js/200.434715d2.js"><link rel="prefetch" href="/doc_notes/assets/js/201.df5e4553.js"><link rel="prefetch" href="/doc_notes/assets/js/202.4f5738c7.js"><link rel="prefetch" href="/doc_notes/assets/js/203.7bdee8f2.js"><link rel="prefetch" href="/doc_notes/assets/js/204.5b4e69e3.js"><link rel="prefetch" href="/doc_notes/assets/js/205.58586a6e.js"><link rel="prefetch" href="/doc_notes/assets/js/206.b5603313.js"><link rel="prefetch" href="/doc_notes/assets/js/207.e1a4577a.js"><link rel="prefetch" href="/doc_notes/assets/js/208.2369d699.js"><link rel="prefetch" href="/doc_notes/assets/js/209.baadeea1.js"><link rel="prefetch" href="/doc_notes/assets/js/21.1cff06fb.js"><link rel="prefetch" href="/doc_notes/assets/js/210.2b107173.js"><link rel="prefetch" href="/doc_notes/assets/js/211.c8eea835.js"><link rel="prefetch" href="/doc_notes/assets/js/212.1fae6417.js"><link rel="prefetch" href="/doc_notes/assets/js/213.5696d97f.js"><link rel="prefetch" href="/doc_notes/assets/js/214.bbd783da.js"><link rel="prefetch" href="/doc_notes/assets/js/215.1c0c350c.js"><link rel="prefetch" href="/doc_notes/assets/js/216.498044dc.js"><link rel="prefetch" href="/doc_notes/assets/js/217.319f81c6.js"><link rel="prefetch" href="/doc_notes/assets/js/218.8911d413.js"><link rel="prefetch" href="/doc_notes/assets/js/219.f37e96ea.js"><link rel="prefetch" href="/doc_notes/assets/js/22.2cd72a62.js"><link rel="prefetch" href="/doc_notes/assets/js/220.b5ac8e75.js"><link rel="prefetch" href="/doc_notes/assets/js/221.cde91cfa.js"><link rel="prefetch" href="/doc_notes/assets/js/222.df059246.js"><link rel="prefetch" href="/doc_notes/assets/js/223.3ce433b3.js"><link rel="prefetch" href="/doc_notes/assets/js/224.36f2c1ff.js"><link rel="prefetch" href="/doc_notes/assets/js/225.fbee00f9.js"><link rel="prefetch" href="/doc_notes/assets/js/226.306f0e70.js"><link rel="prefetch" href="/doc_notes/assets/js/227.4e7373a0.js"><link rel="prefetch" href="/doc_notes/assets/js/228.44fd0171.js"><link rel="prefetch" href="/doc_notes/assets/js/229.f832a1d6.js"><link rel="prefetch" href="/doc_notes/assets/js/23.e9957abc.js"><link rel="prefetch" href="/doc_notes/assets/js/231.7616cdd1.js"><link rel="prefetch" href="/doc_notes/assets/js/232.c3eb262d.js"><link rel="prefetch" href="/doc_notes/assets/js/233.645ff598.js"><link rel="prefetch" href="/doc_notes/assets/js/234.bb763bdf.js"><link rel="prefetch" href="/doc_notes/assets/js/235.f6724c17.js"><link rel="prefetch" href="/doc_notes/assets/js/236.2fe5969c.js"><link rel="prefetch" href="/doc_notes/assets/js/237.c379ae13.js"><link rel="prefetch" href="/doc_notes/assets/js/238.bc474d07.js"><link rel="prefetch" href="/doc_notes/assets/js/239.b4b3094b.js"><link rel="prefetch" href="/doc_notes/assets/js/24.e4e0f07a.js"><link rel="prefetch" href="/doc_notes/assets/js/240.b7298fad.js"><link rel="prefetch" href="/doc_notes/assets/js/241.edc191c3.js"><link rel="prefetch" href="/doc_notes/assets/js/242.d79274ed.js"><link rel="prefetch" href="/doc_notes/assets/js/243.db97328a.js"><link rel="prefetch" href="/doc_notes/assets/js/244.68cd4704.js"><link rel="prefetch" href="/doc_notes/assets/js/245.f501295b.js"><link rel="prefetch" href="/doc_notes/assets/js/246.ddc4d5d9.js"><link rel="prefetch" href="/doc_notes/assets/js/247.ff22cc5b.js"><link rel="prefetch" href="/doc_notes/assets/js/248.4a61cd51.js"><link rel="prefetch" href="/doc_notes/assets/js/249.be49f5ca.js"><link rel="prefetch" href="/doc_notes/assets/js/25.c7ae079a.js"><link rel="prefetch" href="/doc_notes/assets/js/250.43caa09e.js"><link rel="prefetch" href="/doc_notes/assets/js/251.26d5a6e9.js"><link rel="prefetch" href="/doc_notes/assets/js/252.b3bcf0c8.js"><link rel="prefetch" href="/doc_notes/assets/js/253.1a1b2b11.js"><link rel="prefetch" href="/doc_notes/assets/js/254.1c4090ef.js"><link rel="prefetch" href="/doc_notes/assets/js/255.a49e9f41.js"><link rel="prefetch" href="/doc_notes/assets/js/256.78de4e85.js"><link rel="prefetch" href="/doc_notes/assets/js/257.3f3d8408.js"><link rel="prefetch" href="/doc_notes/assets/js/258.2a59b276.js"><link rel="prefetch" href="/doc_notes/assets/js/259.8916e4fc.js"><link rel="prefetch" href="/doc_notes/assets/js/26.1ae4ceb3.js"><link rel="prefetch" href="/doc_notes/assets/js/260.9e38f578.js"><link rel="prefetch" href="/doc_notes/assets/js/261.bb658a8a.js"><link rel="prefetch" href="/doc_notes/assets/js/262.e3dc3020.js"><link rel="prefetch" href="/doc_notes/assets/js/263.f1020a9b.js"><link rel="prefetch" href="/doc_notes/assets/js/264.b8f1ff3a.js"><link rel="prefetch" href="/doc_notes/assets/js/265.d3eb13d8.js"><link rel="prefetch" href="/doc_notes/assets/js/266.f27ca21b.js"><link rel="prefetch" href="/doc_notes/assets/js/267.338c834f.js"><link rel="prefetch" href="/doc_notes/assets/js/268.b9ebda2b.js"><link rel="prefetch" href="/doc_notes/assets/js/269.dc7525cf.js"><link rel="prefetch" href="/doc_notes/assets/js/27.42caa565.js"><link rel="prefetch" href="/doc_notes/assets/js/270.137ed51c.js"><link rel="prefetch" href="/doc_notes/assets/js/271.b6fdb998.js"><link rel="prefetch" href="/doc_notes/assets/js/272.ddc1ee03.js"><link rel="prefetch" href="/doc_notes/assets/js/273.df6133aa.js"><link rel="prefetch" href="/doc_notes/assets/js/274.9115305d.js"><link rel="prefetch" href="/doc_notes/assets/js/275.13342d76.js"><link rel="prefetch" href="/doc_notes/assets/js/276.a9e1f1ec.js"><link rel="prefetch" href="/doc_notes/assets/js/277.f2728f30.js"><link rel="prefetch" href="/doc_notes/assets/js/278.7e726870.js"><link rel="prefetch" href="/doc_notes/assets/js/279.648ad6bd.js"><link rel="prefetch" href="/doc_notes/assets/js/28.45f1bbb9.js"><link rel="prefetch" href="/doc_notes/assets/js/280.720a2918.js"><link rel="prefetch" href="/doc_notes/assets/js/281.5a2d475b.js"><link rel="prefetch" href="/doc_notes/assets/js/282.62bc635b.js"><link rel="prefetch" href="/doc_notes/assets/js/283.ff6be5f5.js"><link rel="prefetch" href="/doc_notes/assets/js/284.3f7c0af1.js"><link rel="prefetch" href="/doc_notes/assets/js/285.c2f51624.js"><link rel="prefetch" href="/doc_notes/assets/js/286.a5b99138.js"><link rel="prefetch" href="/doc_notes/assets/js/287.829ac9bd.js"><link rel="prefetch" href="/doc_notes/assets/js/288.54aabaae.js"><link rel="prefetch" href="/doc_notes/assets/js/289.71b4d090.js"><link rel="prefetch" href="/doc_notes/assets/js/29.0fdf0aa1.js"><link rel="prefetch" href="/doc_notes/assets/js/290.df175e90.js"><link rel="prefetch" href="/doc_notes/assets/js/291.014245fe.js"><link rel="prefetch" href="/doc_notes/assets/js/292.8d375ce2.js"><link rel="prefetch" href="/doc_notes/assets/js/293.8591ceba.js"><link rel="prefetch" href="/doc_notes/assets/js/294.d979d20b.js"><link rel="prefetch" href="/doc_notes/assets/js/295.372c2d39.js"><link rel="prefetch" href="/doc_notes/assets/js/296.07d572ab.js"><link rel="prefetch" href="/doc_notes/assets/js/297.5de1073e.js"><link rel="prefetch" href="/doc_notes/assets/js/298.5a6ac1ca.js"><link rel="prefetch" href="/doc_notes/assets/js/299.e87a7ab3.js"><link rel="prefetch" href="/doc_notes/assets/js/3.8087b6c9.js"><link rel="prefetch" href="/doc_notes/assets/js/30.33c143cb.js"><link rel="prefetch" href="/doc_notes/assets/js/300.c011f877.js"><link rel="prefetch" href="/doc_notes/assets/js/301.479875ba.js"><link rel="prefetch" href="/doc_notes/assets/js/302.fe22cf89.js"><link rel="prefetch" href="/doc_notes/assets/js/303.fe59bc5d.js"><link rel="prefetch" href="/doc_notes/assets/js/304.17566e0f.js"><link rel="prefetch" href="/doc_notes/assets/js/305.235d62da.js"><link rel="prefetch" href="/doc_notes/assets/js/306.6a899aaa.js"><link rel="prefetch" href="/doc_notes/assets/js/307.a6302576.js"><link rel="prefetch" href="/doc_notes/assets/js/308.53d18516.js"><link rel="prefetch" href="/doc_notes/assets/js/309.44746635.js"><link rel="prefetch" href="/doc_notes/assets/js/31.f3c83a33.js"><link rel="prefetch" href="/doc_notes/assets/js/310.2b0b41b5.js"><link rel="prefetch" href="/doc_notes/assets/js/311.a2425d85.js"><link rel="prefetch" href="/doc_notes/assets/js/312.ee8bb224.js"><link rel="prefetch" href="/doc_notes/assets/js/313.cdb7a074.js"><link rel="prefetch" href="/doc_notes/assets/js/314.5c46337b.js"><link rel="prefetch" href="/doc_notes/assets/js/315.d2f5d6ef.js"><link rel="prefetch" href="/doc_notes/assets/js/316.1d1b10d7.js"><link rel="prefetch" href="/doc_notes/assets/js/317.18978adf.js"><link rel="prefetch" href="/doc_notes/assets/js/318.725aaa9e.js"><link rel="prefetch" href="/doc_notes/assets/js/319.10c27323.js"><link rel="prefetch" href="/doc_notes/assets/js/32.2e4a5d25.js"><link rel="prefetch" href="/doc_notes/assets/js/320.be122112.js"><link rel="prefetch" href="/doc_notes/assets/js/321.21d59327.js"><link rel="prefetch" href="/doc_notes/assets/js/322.1c7aa8b5.js"><link rel="prefetch" href="/doc_notes/assets/js/323.61f2e664.js"><link rel="prefetch" href="/doc_notes/assets/js/324.d5ef212c.js"><link rel="prefetch" href="/doc_notes/assets/js/325.8dcaad1a.js"><link rel="prefetch" href="/doc_notes/assets/js/326.27ae755d.js"><link rel="prefetch" href="/doc_notes/assets/js/327.23295181.js"><link rel="prefetch" href="/doc_notes/assets/js/328.b1038029.js"><link rel="prefetch" href="/doc_notes/assets/js/329.685f438a.js"><link rel="prefetch" href="/doc_notes/assets/js/33.78d67de4.js"><link rel="prefetch" href="/doc_notes/assets/js/330.29d01e38.js"><link rel="prefetch" href="/doc_notes/assets/js/331.56ede5a6.js"><link rel="prefetch" href="/doc_notes/assets/js/332.26f5337e.js"><link rel="prefetch" href="/doc_notes/assets/js/333.7a1b5bed.js"><link rel="prefetch" href="/doc_notes/assets/js/334.ccc83ffa.js"><link rel="prefetch" href="/doc_notes/assets/js/335.dd4d24f2.js"><link rel="prefetch" href="/doc_notes/assets/js/336.5cd8a3be.js"><link rel="prefetch" href="/doc_notes/assets/js/337.725cd669.js"><link rel="prefetch" href="/doc_notes/assets/js/338.ca370789.js"><link rel="prefetch" href="/doc_notes/assets/js/339.4db35fe1.js"><link rel="prefetch" href="/doc_notes/assets/js/34.10602eab.js"><link rel="prefetch" href="/doc_notes/assets/js/340.11e5684e.js"><link rel="prefetch" href="/doc_notes/assets/js/341.87af888b.js"><link rel="prefetch" href="/doc_notes/assets/js/342.6288246d.js"><link rel="prefetch" href="/doc_notes/assets/js/343.10836901.js"><link rel="prefetch" href="/doc_notes/assets/js/344.85db1640.js"><link rel="prefetch" href="/doc_notes/assets/js/345.f1a97cf1.js"><link rel="prefetch" href="/doc_notes/assets/js/346.dd502824.js"><link rel="prefetch" href="/doc_notes/assets/js/347.b211385a.js"><link rel="prefetch" href="/doc_notes/assets/js/348.f255c270.js"><link rel="prefetch" href="/doc_notes/assets/js/349.36014517.js"><link rel="prefetch" href="/doc_notes/assets/js/35.03fbbb65.js"><link rel="prefetch" href="/doc_notes/assets/js/350.817bd0e1.js"><link rel="prefetch" href="/doc_notes/assets/js/351.abf45be4.js"><link rel="prefetch" href="/doc_notes/assets/js/352.4254451f.js"><link rel="prefetch" href="/doc_notes/assets/js/353.c0b15b9d.js"><link rel="prefetch" href="/doc_notes/assets/js/354.d725c37e.js"><link rel="prefetch" href="/doc_notes/assets/js/355.10f1ce9b.js"><link rel="prefetch" href="/doc_notes/assets/js/356.a5e2bfda.js"><link rel="prefetch" href="/doc_notes/assets/js/357.80f39a19.js"><link rel="prefetch" href="/doc_notes/assets/js/358.5c69b1d1.js"><link rel="prefetch" href="/doc_notes/assets/js/359.12d21c81.js"><link rel="prefetch" href="/doc_notes/assets/js/36.aa74ba81.js"><link rel="prefetch" href="/doc_notes/assets/js/360.1183658a.js"><link rel="prefetch" href="/doc_notes/assets/js/361.33b745b6.js"><link rel="prefetch" href="/doc_notes/assets/js/362.a56596c0.js"><link rel="prefetch" href="/doc_notes/assets/js/363.1fadef9e.js"><link rel="prefetch" href="/doc_notes/assets/js/364.e43e06a1.js"><link rel="prefetch" href="/doc_notes/assets/js/365.1b191379.js"><link rel="prefetch" href="/doc_notes/assets/js/366.77112bc2.js"><link rel="prefetch" href="/doc_notes/assets/js/367.cbbf1410.js"><link rel="prefetch" href="/doc_notes/assets/js/368.6e4af412.js"><link rel="prefetch" href="/doc_notes/assets/js/369.9d8214a4.js"><link rel="prefetch" href="/doc_notes/assets/js/37.bad965a6.js"><link rel="prefetch" href="/doc_notes/assets/js/370.5dcbc931.js"><link rel="prefetch" href="/doc_notes/assets/js/371.3e798a72.js"><link rel="prefetch" href="/doc_notes/assets/js/372.99fbe027.js"><link rel="prefetch" href="/doc_notes/assets/js/373.783fc78c.js"><link rel="prefetch" href="/doc_notes/assets/js/374.8fc2e9fe.js"><link rel="prefetch" href="/doc_notes/assets/js/375.2831b29c.js"><link rel="prefetch" href="/doc_notes/assets/js/376.8a690d9f.js"><link rel="prefetch" href="/doc_notes/assets/js/377.c6401c22.js"><link rel="prefetch" href="/doc_notes/assets/js/38.57a79422.js"><link rel="prefetch" href="/doc_notes/assets/js/39.7ab71035.js"><link rel="prefetch" href="/doc_notes/assets/js/4.da3ef268.js"><link rel="prefetch" href="/doc_notes/assets/js/40.ffa22594.js"><link rel="prefetch" href="/doc_notes/assets/js/41.b2fc54d1.js"><link rel="prefetch" href="/doc_notes/assets/js/42.c43bc930.js"><link rel="prefetch" href="/doc_notes/assets/js/43.5c93d7a1.js"><link rel="prefetch" href="/doc_notes/assets/js/44.605a54a6.js"><link rel="prefetch" href="/doc_notes/assets/js/45.f85a75a3.js"><link rel="prefetch" href="/doc_notes/assets/js/46.2cd25346.js"><link rel="prefetch" href="/doc_notes/assets/js/47.93f7d1a6.js"><link rel="prefetch" href="/doc_notes/assets/js/48.7fd0b6dc.js"><link rel="prefetch" href="/doc_notes/assets/js/49.c64bb839.js"><link rel="prefetch" href="/doc_notes/assets/js/5.dac787d8.js"><link rel="prefetch" href="/doc_notes/assets/js/50.d2fe7364.js"><link rel="prefetch" href="/doc_notes/assets/js/51.b9189617.js"><link rel="prefetch" href="/doc_notes/assets/js/52.4689b562.js"><link rel="prefetch" href="/doc_notes/assets/js/53.f0b1d96b.js"><link rel="prefetch" href="/doc_notes/assets/js/54.f52a48ab.js"><link rel="prefetch" href="/doc_notes/assets/js/55.98bfca4a.js"><link rel="prefetch" href="/doc_notes/assets/js/56.6c0a81f6.js"><link rel="prefetch" href="/doc_notes/assets/js/57.e17dfa82.js"><link rel="prefetch" href="/doc_notes/assets/js/58.f9a5000b.js"><link rel="prefetch" href="/doc_notes/assets/js/59.3296ea1c.js"><link rel="prefetch" href="/doc_notes/assets/js/6.2d0a63f8.js"><link rel="prefetch" href="/doc_notes/assets/js/60.610d4eca.js"><link rel="prefetch" href="/doc_notes/assets/js/61.64b18740.js"><link rel="prefetch" href="/doc_notes/assets/js/62.87e34293.js"><link rel="prefetch" href="/doc_notes/assets/js/63.fbd2d78b.js"><link rel="prefetch" href="/doc_notes/assets/js/64.493b857a.js"><link rel="prefetch" href="/doc_notes/assets/js/65.0a60479c.js"><link rel="prefetch" href="/doc_notes/assets/js/66.800419f9.js"><link rel="prefetch" href="/doc_notes/assets/js/67.343f5dab.js"><link rel="prefetch" href="/doc_notes/assets/js/68.fed77f78.js"><link rel="prefetch" href="/doc_notes/assets/js/69.8b1601da.js"><link rel="prefetch" href="/doc_notes/assets/js/7.c9d31aa2.js"><link rel="prefetch" href="/doc_notes/assets/js/70.aedd0ab9.js"><link rel="prefetch" href="/doc_notes/assets/js/71.b166238f.js"><link rel="prefetch" href="/doc_notes/assets/js/72.27a66c82.js"><link rel="prefetch" href="/doc_notes/assets/js/73.1d9b487f.js"><link rel="prefetch" href="/doc_notes/assets/js/74.84702901.js"><link rel="prefetch" href="/doc_notes/assets/js/75.2f6ae560.js"><link rel="prefetch" href="/doc_notes/assets/js/76.4856c210.js"><link rel="prefetch" href="/doc_notes/assets/js/77.9fc6950e.js"><link rel="prefetch" href="/doc_notes/assets/js/78.cb2f07a0.js"><link rel="prefetch" href="/doc_notes/assets/js/79.5e43d0b7.js"><link rel="prefetch" href="/doc_notes/assets/js/8.da9db8f9.js"><link rel="prefetch" href="/doc_notes/assets/js/80.d59ea8af.js"><link rel="prefetch" href="/doc_notes/assets/js/81.9fc53f43.js"><link rel="prefetch" href="/doc_notes/assets/js/82.5838801e.js"><link rel="prefetch" href="/doc_notes/assets/js/83.d2006fd2.js"><link rel="prefetch" href="/doc_notes/assets/js/84.9b965f14.js"><link rel="prefetch" href="/doc_notes/assets/js/85.de0c498b.js"><link rel="prefetch" href="/doc_notes/assets/js/86.ce67f8b8.js"><link rel="prefetch" href="/doc_notes/assets/js/87.5d47b003.js"><link rel="prefetch" href="/doc_notes/assets/js/88.eee9be64.js"><link rel="prefetch" href="/doc_notes/assets/js/89.42153946.js"><link rel="prefetch" href="/doc_notes/assets/js/9.0ccc34a6.js"><link rel="prefetch" href="/doc_notes/assets/js/90.13a9f4b2.js"><link rel="prefetch" href="/doc_notes/assets/js/91.832ae5d2.js"><link rel="prefetch" href="/doc_notes/assets/js/92.bd7c25ca.js"><link rel="prefetch" href="/doc_notes/assets/js/93.8a6f3f34.js"><link rel="prefetch" href="/doc_notes/assets/js/94.221348bd.js"><link rel="prefetch" href="/doc_notes/assets/js/95.86b48f96.js"><link rel="prefetch" href="/doc_notes/assets/js/96.7c6d0372.js"><link rel="prefetch" href="/doc_notes/assets/js/97.307341f8.js"><link rel="prefetch" href="/doc_notes/assets/js/98.14120c7c.js"><link rel="prefetch" href="/doc_notes/assets/js/99.40560c36.js">
    <link rel="stylesheet" href="/doc_notes/assets/css/0.styles.60b82a90.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/doc_notes/" class="home-link router-link-active"><!----> <span class="site-name">Obsidian notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/doc_notes/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/doc_notes/config/" class="nav-link">
  Config
</a></div><div class="nav-item"><a href="https://v1.vuepress.vuejs.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  VuePress
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/doc_notes/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/doc_notes/config/" class="nav-link">
  Config
</a></div><div class="nav-item"><a href="https://v1.vuepress.vuejs.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  VuePress
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><p>https://www.toptal.com/graphql/laravel-graphql-server-tutorial</p> <p>In case you’re still not familiar with it, GraphQL is a query language used to interact with your API which <a href="https://www.toptal.com/api-development/graphql-vs-rest-tutorial" target="_blank" rel="noopener noreferrer">provides some benefits<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> compared to alternative architectures such as REST. GraphQL is extremely handy when used to serve as an endpoint for mobile and single-page applications. GraphQL allows you to query nested and related data in a request with relative ease, allowing developers to obtain the exact data they need in a single round trip to the server.</p> <p><a href="https://laravel.com/" target="_blank" rel="noopener noreferrer">Laravel<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is a popular, opinionated PHP web framework. It provides numerous built-in tools to get applications up and running quickly, but it also allows developers to swap out their own implementations for Laravel’s built-in interfaces when preferred.</p> <p>Although the communities surrounding both GraphQL and Laravel have grown dramatically since they were open-sourced, documentation explaining how to use these two technologies together is still somewhat scarce.</p> <p>So, in this tutorial, I will show you how to create your own GraphQL server using Laravel.</p> <h2 id="project-overview"><a href="#project-overview" class="header-anchor">#</a> Project Overview</h2> <p><a href="https://uploads.toptal.io/blog/image/129751/toptal-blog-image-1558175797581-6141ca718b94392caef461d23116f8f9.png" target="_blank" rel="noopener noreferrer"><img src="https://assets.toptal.io/images?url=https://uploads.toptal.io/blog/image/129751/toptal-blog-image-1558175797581-6141ca718b94392caef461d23116f8f9.png" alt="GraphQL server overview illustration"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Before we get started, we’ll need to get familiar with the project we are attempting to build. To do that, we will define our resources and create our GraphQL schema, which we will later use to serve our API.</p> <h3 id="project-resources"><a href="#project-resources" class="header-anchor">#</a> Project Resources</h3> <p>Our application will consist of two resources: <em>Articles</em> and <em>Users</em>. These resources will be defined as object types in our GraphQL schema:</p> <div class="language-php extra-class"><pre class="language-php"><code>type User <span class="token punctuation">{</span>
  id<span class="token punctuation">:</span> <span class="token constant">ID</span><span class="token operator">!</span>
  name<span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span>
  email<span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span>
  articles<span class="token punctuation">:</span> <span class="token punctuation">[</span>Article<span class="token operator">!</span><span class="token punctuation">]</span><span class="token operator">!</span>
<span class="token punctuation">}</span>

type Article <span class="token punctuation">{</span>
  id<span class="token punctuation">:</span> <span class="token constant">ID</span><span class="token operator">!</span>
  title<span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span>
  content<span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span>
  author<span class="token punctuation">:</span> User<span class="token operator">!</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Looking at the schema, we can see that we have a one-to-many relationship between our two objects. Users can write many articles, and an article has an author (user) assigned to it.</p> <p>Now that we have our object types defined, we’ll need a way to create and query our data, so let’s define our query and mutation objects:</p> <div class="language-php extra-class"><pre class="language-php"><code>type Query <span class="token punctuation">{</span>
<span class="token function">user</span><span class="token punctuation">(</span><span class="token argument-name">id</span><span class="token punctuation">:</span> <span class="token constant">ID</span><span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">User</span>
  users<span class="token punctuation">:</span> <span class="token punctuation">[</span>User<span class="token operator">!</span><span class="token punctuation">]</span><span class="token operator">!</span>

  <span class="token function">article</span><span class="token punctuation">(</span><span class="token argument-name">id</span><span class="token punctuation">:</span> <span class="token constant">ID</span><span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">Article</span>
  articles<span class="token punctuation">:</span> <span class="token punctuation">[</span>Article<span class="token operator">!</span><span class="token punctuation">]</span><span class="token operator">!</span>
<span class="token punctuation">}</span>

type Mutation <span class="token punctuation">{</span>
  <span class="token function">createUser</span><span class="token punctuation">(</span><span class="token argument-name">name</span><span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span><span class="token punctuation">,</span> <span class="token argument-name">email</span><span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span><span class="token punctuation">,</span> <span class="token argument-name">password</span><span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">User</span>
  <span class="token function">createArticle</span><span class="token punctuation">(</span><span class="token argument-name">title</span><span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span><span class="token punctuation">,</span> <span class="token argument-name">content</span><span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">Article</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="setting-up-our-laravel-project"><a href="#setting-up-our-laravel-project" class="header-anchor">#</a> Setting Up Our Laravel Project</h2> <p>Now that we’ve defined our GraphQL schema, let’s get our Laravel project up and running. Let’s start by creating a new Laravel via Composer project:</p> <div class="language-php extra-class"><pre class="language-php"><code>$ composer create<span class="token operator">-</span>project <span class="token operator">--</span>prefer<span class="token operator">-</span>dist laravel<span class="token operator">/</span>laravel laravel<span class="token operator">-</span>graphql
</code></pre></div><p>Just to make sure we have everything working, let’s boot up our server and make sure we see Laravel’s default page:</p> <div class="language-php extra-class"><pre class="language-php"><code>$ cd laravel<span class="token operator">-</span><span class="token class-name type-declaration">graphql</span>
$ php artisan serve
Laravel development server started<span class="token punctuation">:</span> <span class="token operator">&lt;</span>http<span class="token punctuation">:</span><span class="token comment">//127.0.0.1:8000&gt;</span>
</code></pre></div><h3 id="database-models-and-migrations"><a href="#database-models-and-migrations" class="header-anchor">#</a> Database Models and Migrations</h3> <p>For the purposes of this article, we will be using SQLite. So, let’s make the following changes to the default <code>.env</code> file:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token constant">DB_CONNECTION</span><span class="token operator">=</span>sqlite
<span class="token comment"># DB_HOST=</span>
<span class="token comment"># DB_PORT=</span>
<span class="token comment"># DB_DATABASE=database.sqlite</span>
<span class="token comment"># DB_USERNAME=</span>
<span class="token comment"># DB_PASSWORD=</span>
</code></pre></div><p>Next, let’s create our database file:</p> <div class="language-php extra-class"><pre class="language-php"><code>$ touch <span class="token operator">.</span><span class="token operator">/</span>database<span class="token operator">/</span>database<span class="token operator">.</span>sqlite
</code></pre></div><p>Laravel ships with a user model and some basic migration files. Let’s quickly add an <code>api_token</code> column to our in our <code>CreateUsersTable</code> migration file provided to us by Laravel:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token operator">/</span>database<span class="token operator">/</span>migrations<span class="token operator">/</span>XXXX_XX_XX_000000_create_users_table<span class="token operator">.</span>php
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span class="token punctuation">\</span>Migrations<span class="token punctuation">\</span>Migration</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span class="token punctuation">\</span>Schema<span class="token punctuation">\</span>Blueprint</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Schema</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">CreateUsersTable</span> <span class="token keyword">extends</span> <span class="token class-name">Migration</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Run the migrations.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">up</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name static-context">Schema</span><span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'users'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token class-name type-declaration">Blueprint</span> <span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">bigIncrements</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'email'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">timestamp</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'email_verified_at'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">nullable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'api_token'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">nullable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">rememberToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">timestamps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Reverse the migrations.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">down</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name static-context">Schema</span><span class="token operator">::</span><span class="token function">dropIfExists</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'users'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>We’ll circle back to this additional column later on in the article when we get to authorization. Now let’s go ahead and create our article model and a migration file to create the associated table:</p> <div class="language-php extra-class"><pre class="language-php"><code>$ php artisan make<span class="token punctuation">:</span>model Article <span class="token operator">-</span>m
</code></pre></div><p><strong>Note:</strong> <em>The -m option creates a migration file for our newly created article model.</em></p> <p>Let’s make some adjustments to the generated migration file:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Schema</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span class="token punctuation">\</span>Schema<span class="token punctuation">\</span>Blueprint</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span class="token punctuation">\</span>Migrations<span class="token punctuation">\</span>Migration</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">CreateArticlesTable</span> <span class="token keyword">extends</span> <span class="token class-name">Migration</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Run the migrations.
     *
     * @return void
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">up</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name static-context">Schema</span><span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'articles'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token class-name type-declaration">Blueprint</span> <span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">bigIncrements</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">unsignedBigInteger</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'user_id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'title'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">timestamps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token variable">$table</span><span class="token operator">-&gt;</span><span class="token function">foreign</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'user_id'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">references</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'users'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Reverse the migrations.
     *
     * @return void
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">down</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name static-context">Schema</span><span class="token operator">::</span><span class="token function">dropIfExists</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'articles'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>We’ve added a foreign key pointing to the <code>id</code> on our <code>users</code> table as well as the <code>title</code> and <code>content</code> columns we defined in our GraphQL schema.</p> <p>Now that we have our migration files defined, let’s go ahead and run them against our database:</p> <div class="language-php extra-class"><pre class="language-php"><code>$ php artisan migrate
</code></pre></div><p>Next, let’s update our models by defining the necessary relationships:</p> <div class="language-php extra-class"><pre class="language-php"><code>app<span class="token operator">/</span>User<span class="token operator">.</span>php
<span class="token keyword">namespace</span> <span class="token package">App</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Notifications<span class="token punctuation">\</span>Notifiable</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Auth<span class="token punctuation">\</span>User</span> <span class="token keyword">as</span> Authenticatable<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Authenticatable</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">Notifiable</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * The attributes that are mass assignable.
     *
     * @var array
     */</span>
    <span class="token keyword">protected</span> <span class="token variable">$fillable</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'name'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'email'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'password'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// ...</span>

    <span class="token comment">/**
     * @return \Illuminate\Database\Eloquent\Relations\HasMany
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">articles</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">hasMany</span><span class="token punctuation">(</span><span class="token class-name static-context">Article</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code>app<span class="token operator">/</span>Article<span class="token operator">.</span>php
<span class="token keyword">namespace</span> <span class="token package">App</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span class="token punctuation">\</span>Eloquent<span class="token punctuation">\</span>Model</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Article</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * The attributes that are mass assignable.
     *
     * @var array
     */</span>
    <span class="token keyword">protected</span> <span class="token variable">$fillable</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string single-quoted-string">'title'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'content'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * @return \Illuminate\Database\Eloquent\Relations\BelongsTo
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">belongsTo</span><span class="token punctuation">(</span><span class="token class-name static-context">User</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="database-seeding"><a href="#database-seeding" class="header-anchor">#</a> Database Seeding</h3> <p>Now that we have our models and migrations set up, let’s seed our database. We’ll start by creating some seeder classes for our <code>articles</code> and <code>users</code> tables:</p> <div class="language-php extra-class"><pre class="language-php"><code>$ php artisan make<span class="token punctuation">:</span>seeder <span class="token class-name type-declaration">UsersTableSeeder</span> 
$ php artisan make<span class="token punctuation">:</span>seeder ArticlesTableSeeder
</code></pre></div><p>Next, let’s set them up to insert some dummy data into our SQLite database:</p> <div class="language-php extra-class"><pre class="language-php"><code>database<span class="token operator">/</span>seeds<span class="token operator">/</span>UsersTableSeeder<span class="token operator">.</span>php
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span class="token punctuation">\</span>Seeder</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">UsersTableSeeder</span> <span class="token keyword">extends</span> <span class="token class-name">Seeder</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Run the database seeds.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\</span>App<span class="token punctuation">\</span>User</span><span class="token operator">::</span><span class="token function">truncate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token variable">$faker</span> <span class="token operator">=</span> <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\</span>Faker<span class="token punctuation">\</span>Factory</span><span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token function">bcrypt</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'secret'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\</span>App<span class="token punctuation">\</span>User</span><span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token string single-quoted-string">'name'</span>     <span class="token operator">=&gt;</span> <span class="token variable">$faker</span><span class="token operator">-&gt;</span><span class="token property">name</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'email'</span>    <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">'graphql@test.com'</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'password'</span> <span class="token operator">=&gt;</span> <span class="token variable">$password</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span><span class="token variable">$i</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\</span>App<span class="token punctuation">\</span>User</span><span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
                <span class="token string single-quoted-string">'name'</span>     <span class="token operator">=&gt;</span> <span class="token variable">$faker</span><span class="token operator">-&gt;</span><span class="token property">name</span><span class="token punctuation">,</span>
                <span class="token string single-quoted-string">'email'</span>    <span class="token operator">=&gt;</span> <span class="token variable">$faker</span><span class="token operator">-&gt;</span><span class="token property">email</span><span class="token punctuation">,</span>
                <span class="token string single-quoted-string">'password'</span> <span class="token operator">=&gt;</span> <span class="token variable">$password</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code>database<span class="token operator">/</span>seeds<span class="token operator">/</span>ArticlesTableSeeder<span class="token operator">.</span>php
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Article</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span class="token punctuation">\</span>Seeder</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">ArticlesTableSeeder</span> <span class="token keyword">extends</span> <span class="token class-name">Seeder</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Run the database seeds.
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\</span>App<span class="token punctuation">\</span>Article</span><span class="token operator">::</span><span class="token function">truncate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\</span>App<span class="token punctuation">\</span>Article</span><span class="token operator">::</span><span class="token function">unguard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token variable">$faker</span> <span class="token operator">=</span> <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\</span>Faker<span class="token punctuation">\</span>Factory</span><span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\</span>App<span class="token punctuation">\</span>User</span><span class="token operator">::</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span> <span class="token keyword">use</span> <span class="token punctuation">(</span><span class="token variable">$faker</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$i</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\</span>App<span class="token punctuation">\</span>Article</span><span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
                    <span class="token string single-quoted-string">'user_id'</span> <span class="token operator">=&gt;</span> <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token property">id</span><span class="token punctuation">,</span>
                    <span class="token string single-quoted-string">'title'</span>   <span class="token operator">=&gt;</span> <span class="token variable">$faker</span><span class="token operator">-&gt;</span><span class="token property">sentence</span><span class="token punctuation">,</span>
                    <span class="token string single-quoted-string">'content'</span> <span class="token operator">=&gt;</span> <span class="token variable">$faker</span><span class="token operator">-&gt;</span><span class="token function">paragraphs</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code><span class="token operator">/</span>database<span class="token operator">/</span>seeds<span class="token operator">/</span>DatabaseSeeder<span class="token operator">.</span>php
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Database<span class="token punctuation">\</span>Seeder</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">DatabaseSeeder</span> <span class="token keyword">extends</span> <span class="token class-name">Seeder</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Seed the application's database.
     *
     * @return void
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token class-name static-context">UsersTableSeeder</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token class-name static-context">ArticlesTableSeeder</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Finally, let’s go ahead and run our database seeders to get some data into our database:</p> <div class="language-php extra-class"><pre class="language-php"><code>$ php artisan db<span class="token punctuation">:</span>seed
</code></pre></div><h2 id="laravel-lighthouse-and-graphql-server"><a href="#laravel-lighthouse-and-graphql-server" class="header-anchor">#</a> Laravel Lighthouse and GraphQL Server</h2> <p>Now that we have our database and models set up, it’s time to start building out our GraphQL server. Currently, there are several solutions available for Laravel, but for this article, we’re going to use <a href="https://github.com/nuwave/lighthouse" target="_blank" rel="noopener noreferrer">Lighthouse<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Lighthouse is a package I created a few years ago and has recently seen some amazing support from the growing community around it. It allows developers to quickly set up a GraphQL server using Laravel with little boilerplate while also being flexible enough to allow developers to customize it to fit the needs of just about any project.</p> <p><a href="https://uploads.toptal.io/blog/image/129752/toptal-blog-image-1558175833847-73781ef1a1cab2d92f04ef4cb0709e85.png" target="_blank" rel="noopener noreferrer"><img src="https://assets.toptal.io/images?url=https://uploads.toptal.io/blog/image/129752/toptal-blog-image-1558175833847-73781ef1a1cab2d92f04ef4cb0709e85.png" alt="Laravel Lighthouse and GraphQL Server illustration"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Let’s start by pulling the package into our project:</p> <div class="language-php extra-class"><pre class="language-php"><code>$ composer <span class="token keyword">require</span> nuwave<span class="token operator">/</span>lighthouse<span class="token punctuation">:</span><span class="token string double-quoted-string">&quot;3.1.*&quot;</span>
</code></pre></div><p>Next, let’s publish Lighthouse’s configuration file:</p> <div class="language-php extra-class"><pre class="language-php"><code>$ php artisan vendor<span class="token punctuation">:</span>publish <span class="token operator">--</span>provider<span class="token operator">=</span><span class="token string double-quoted-string">&quot;Nuwave\Lighthouse\LighthouseServiceProvider&quot;</span> <span class="token operator">--</span>tag<span class="token operator">=</span>config
</code></pre></div><p><strong>Note:</strong> <em>You can also choose to publish Lighthouse’s default schema file by simply removing the <code>--tag=config</code> option. But for the purposes of this article, we are going to create our schema file from scratch.</em></p> <p>If we take a look at the <code>config/lighthouse.php</code> file you’ll notice a setting used to register our schema file with Lighthouse:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token string single-quoted-string">'schema'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
    <span class="token string single-quoted-string">'register'</span> <span class="token operator">=&gt;</span> <span class="token function">base_path</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'graphql/schema.graphql'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p>So let’s go ahead and create our schema file and set up our user object type and query:</p> <div class="language-php extra-class"><pre class="language-php"><code>$ mkdir <span class="token class-name type-declaration">graphql</span>
$ touch <span class="token operator">.</span><span class="token operator">/</span>graphql<span class="token operator">/</span>schema<span class="token operator">.</span>graphql

<span class="token operator">/</span>graphql<span class="token operator">/</span>schema<span class="token operator">.</span>graphql
type User <span class="token punctuation">{</span>
  id<span class="token punctuation">:</span> <span class="token constant">ID</span><span class="token operator">!</span>
  name<span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span>
  email<span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span>
<span class="token punctuation">}</span>

type Query <span class="token punctuation">{</span>
  <span class="token function">user</span><span class="token punctuation">(</span><span class="token argument-name">id</span><span class="token punctuation">:</span> <span class="token constant">ID</span><span class="token operator">!</span> @eq<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">User</span> @find
  users<span class="token punctuation">:</span> <span class="token punctuation">[</span>User<span class="token operator">!</span><span class="token punctuation">]</span><span class="token operator">!</span> @all
<span class="token punctuation">}</span>
</code></pre></div><p>You’ll notice that our schema looks similar to the one we defined earlier except we’ve added some identifiers called <a href="https://www.apollographql.com/docs/graphql-tools/schema-directives" target="_blank" rel="noopener noreferrer">schema directives<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Let’s take a moment to break down our defined schema. Our first definition is an <em>object type</em> called <code>User</code> which has a relation to our <code>App\User</code> eloquent model. We defined the <code>id</code>, <code>name</code> and <code>email</code> as fields that can be queried off our <code>User</code> models. Alternatively, this means that the <code>password</code>, <code>created_at</code> and <code>updated_at</code> columns are fields that cannot be queried for from our API.</p> <p>Next we have our <code>Query</code> type which is an entry point into our API and can be used to query for data. Our first field is the <code>users</code> field which returns an array of <code>User</code> object types. The <code>@all</code> directive tells Lighthouse to run an Eloquent query, using our <code>User</code> model and get all of the results. This would be the same as running the following:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$users</span> <span class="token operator">=</span> <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\</span>App<span class="token punctuation">\</span>User</span><span class="token operator">::</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Note:</strong> <em>Lighthouse knows to look for a model in the <code>\App\User</code> namespace because of the <code>namespaces</code> option defined in its configuration file.</em></p> <p>Our second defined field on our query type is the call <code>user</code>, which takes an <code>id</code> as an argument and returns a single <code>User</code> object type. We’ve also added two directives to help Lighthouse automatically build a query for us and return a single <code>User</code> model. The <code>@eq</code> directive tells Lighthouse to add a where on our <code>id</code> column, and the <code>@find</code> directive instructs Lighthouse to return a single result. To write this query using Laravel’s query builder, it would look like this:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$user</span> <span class="token operator">=</span> <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\</span>App<span class="token punctuation">\</span>User</span><span class="token operator">::</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="querying-our-graphql-api"><a href="#querying-our-graphql-api" class="header-anchor">#</a> Querying Our GraphQL API</h3> <p>Now that we have a bit of insight into how Lighthouse uses our schema to create queries, let’s run our server and start querying data. We’ll start by running our server:</p> <div class="language-php extra-class"><pre class="language-php"><code>$ php artisan serve
Laravel development server started<span class="token punctuation">:</span> <span class="token operator">&lt;</span>http<span class="token punctuation">:</span><span class="token comment">//127.0.0.1:8000&gt;</span>
</code></pre></div><p>To query a GraphQL endpoint, you could run cURL command in the terminal or a standard client such as Postman. However, to get the full benefits of GraphQL (such as autocomplete, error highlighting, documentation, etc., we’ll use <a href="https://github.com/prisma/graphql-playground" target="_blank" rel="noopener noreferrer">GraphQL Playground<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (release downloads <a href="https://github.com/prisma/graphql-playground/releases" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>).</p> <p>When starting up Playground, click on the “URL Endpoint” tab, and type in <a href="http://localhost:8000/graphql" target="_blank" rel="noopener noreferrer">http://localhost:8000/graphql<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to point GraphQL Playground to our server. On the left side of the editor, we can query for our data, so let’s start by asking for all the users that we seeded the database with:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span>
  users <span class="token punctuation">{</span>
    id
    email
    name
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>When you hit the play button in the middle of the IDE (or click <strong>Ctrl+Enter</strong>), you’ll see the JSON output of our server on the right side, which will look something like this:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span>
  <span class="token string double-quoted-string">&quot;data&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string double-quoted-string">&quot;users&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;1&quot;</span><span class="token punctuation">,</span>
        <span class="token string double-quoted-string">&quot;email&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;graphql@test.com&quot;</span><span class="token punctuation">,</span>
        <span class="token string double-quoted-string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Carolyn Powlowski&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;2&quot;</span><span class="token punctuation">,</span>
        <span class="token string double-quoted-string">&quot;email&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;kheaney@yahoo.com&quot;</span><span class="token punctuation">,</span>
        <span class="token string double-quoted-string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Elouise Raynor&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;3&quot;</span><span class="token punctuation">,</span>
        <span class="token string double-quoted-string">&quot;email&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;orlando.sipes@yahoo.com&quot;</span><span class="token punctuation">,</span>
        <span class="token string double-quoted-string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Mrs. Dejah Wiza&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token operator">...</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Note:</strong> <em>Because we used Faker to seed our database, the data in the <code>email</code> and <code>name</code> fields will be different.</em></p> <p>Now let’s try querying for a single user:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span>
  <span class="token function">user</span><span class="token punctuation">(</span><span class="token argument-name">id</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    email
    name
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>And we’ll get the following output for a single user:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span>
  <span class="token string double-quoted-string">&quot;data&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string double-quoted-string">&quot;user&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string double-quoted-string">&quot;email&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;graphql@test.com&quot;</span><span class="token punctuation">,</span>
      <span class="token string double-quoted-string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Carolyn Powlowski&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Querying for data like this is nice to get started with, but it’s highly unlikely you’ll be in a project where you would ever want to query for <em>all</em> of your data, so let’s try to add in some pagination. When looking through Lighthouse’s wide range of <a href="https://lighthouse-php.com/5/api-reference/directives.html" target="_blank" rel="noopener noreferrer">built-in directives<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, we have a <code>@paginate</code> directive readily available to us, so let’s update our schema’s query object like so:</p> <div class="language-php extra-class"><pre class="language-php"><code>type Query <span class="token punctuation">{</span>
  <span class="token function">user</span><span class="token punctuation">(</span><span class="token argument-name">id</span><span class="token punctuation">:</span> <span class="token constant">ID</span><span class="token operator">!</span> @eq<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">User</span> @find
  users<span class="token punctuation">:</span> <span class="token punctuation">[</span>User<span class="token operator">!</span><span class="token punctuation">]</span><span class="token operator">!</span> @paginate
<span class="token punctuation">}</span>
</code></pre></div><p>If we reload GraphQL Playground (<strong>Ctrl/Cmd + R</strong>) and try our <code>users</code> query again, you’ll notice that we get an error message stating <code>Cannot query field &quot;id&quot; on type &quot;UserPaginator&quot;</code>, so what happened? Behind the scenes, Lighthouse manipulates our schema for us to get a paginated set of results and does so by changing the return type of our <code>users</code> field.</p> <p>Let’s take a closer look by inspecting our schema in GraphQL Playground’s “Docs” tab. If you take a look at the <code>users</code> field, it is returning a <code>UserPaginator</code> which returns an array of users and a Lighthouse defined <code>PaginatorInfo</code> type:</p> <div class="language-php extra-class"><pre class="language-php"><code>type UserPaginator <span class="token punctuation">{</span>
  paginatorInfo<span class="token punctuation">:</span> PaginatorInfo<span class="token operator">!</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">[</span>User<span class="token operator">!</span><span class="token punctuation">]</span><span class="token operator">!</span>
<span class="token punctuation">}</span>

type PaginatorInfo <span class="token punctuation">{</span>
  count<span class="token punctuation">:</span> <span class="token keyword type-declaration">Int</span><span class="token operator">!</span>
  currentPage<span class="token punctuation">:</span> <span class="token keyword type-declaration">Int</span><span class="token operator">!</span>
  firstItem<span class="token punctuation">:</span> <span class="token keyword type-declaration">Int</span>
  hasMorePages<span class="token punctuation">:</span> Boolean<span class="token operator">!</span>
  lastItem<span class="token punctuation">:</span> <span class="token keyword type-declaration">Int</span>
  lastPage<span class="token punctuation">:</span> <span class="token keyword type-declaration">Int</span><span class="token operator">!</span>
  perPage<span class="token punctuation">:</span> <span class="token keyword type-declaration">Int</span><span class="token operator">!</span>
  total<span class="token punctuation">:</span> <span class="token keyword type-declaration">Int</span><span class="token operator">!</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If you’re familiar with Laravel’s built-in pagination, the fields available in the <code>PaginatorInfo</code> type will probably look very familiar to you. So, to query for two users, get the total number of users in the system, and check we have more pages to cycle through, we would send the following query:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span>
  <span class="token function">users</span><span class="token punctuation">(</span><span class="token argument-name">count</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    paginatorInfo <span class="token punctuation">{</span>
      total
      hasMorePages
    <span class="token punctuation">}</span>
    data <span class="token punctuation">{</span>
      id
      name
      email
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Which will provide us with the following response:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span>
  <span class="token string double-quoted-string">&quot;data&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string double-quoted-string">&quot;users&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string double-quoted-string">&quot;paginatorInfo&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string double-quoted-string">&quot;total&quot;</span><span class="token punctuation">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
        <span class="token string double-quoted-string">&quot;hasMorePages&quot;</span><span class="token punctuation">:</span> <span class="token constant boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string double-quoted-string">&quot;data&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;1&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Carolyn Powlowski&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;email&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;graphql@test.com&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;2&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Elouise Raynor&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;email&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;kheaney@yahoo.com&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="relationships"><a href="#relationships" class="header-anchor">#</a> Relationships</h3> <p>Generally, when developing an application, much of your data is related. In our case, a <code>User</code> can write many <code>Articles</code>, so let’s add that relationship to our User type and define our <code>Article</code> type:</p> <div class="language-php extra-class"><pre class="language-php"><code>type User <span class="token punctuation">{</span>
  id<span class="token punctuation">:</span> <span class="token constant">ID</span><span class="token operator">!</span>
  name<span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span>
  email<span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span>
  articles<span class="token punctuation">:</span> <span class="token punctuation">[</span>Article<span class="token operator">!</span><span class="token punctuation">]</span><span class="token operator">!</span> @hasMany
<span class="token punctuation">}</span>

type Article <span class="token punctuation">{</span>
  id<span class="token punctuation">:</span> <span class="token constant">ID</span><span class="token operator">!</span>
  title<span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span>
  content<span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Here, we’re using another Lighthouse provided schema directive <code>@hasMany</code>, which tells Lighthouse our <code>User</code> model has a <code>\Illuminate\Database\Eloquent\Relations\HasMany</code> relationship with the <code>Article</code> model.</p> <p>Now let’s query our newly defined relationship:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span>
  <span class="token function">user</span><span class="token punctuation">(</span><span class="token argument-name">id</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    articles <span class="token punctuation">{</span>
      id
      title
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This will provide us with the following response:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span>
  <span class="token string double-quoted-string">&quot;data&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string double-quoted-string">&quot;user&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string double-quoted-string">&quot;articles&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;1&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Aut velit et temporibus ut et tempora sint.&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;2&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Voluptatem sed labore ea voluptas.&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;3&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Beatae sit et maxime consequatur et natus totam.&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;4&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Corrupti beatae cumque accusamus.&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;5&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Aperiam quidem sit esse rem sed cupiditate.&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Finally, let’s reverse our relationship and add our <code>author</code> relationship to our <code>Article</code> object type using Lighthouse’s <code>@belongsTo</code> schema directive as well as updating our <code>Query</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code>type Article <span class="token punctuation">{</span>
  id<span class="token punctuation">:</span> <span class="token constant">ID</span><span class="token operator">!</span>
  title<span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span>
  content<span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span>
  author<span class="token punctuation">:</span> User<span class="token operator">!</span> @<span class="token function">belongsTo</span><span class="token punctuation">(</span><span class="token argument-name">relation</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;user&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

type Query <span class="token punctuation">{</span>
  <span class="token function">user</span><span class="token punctuation">(</span><span class="token argument-name">id</span><span class="token punctuation">:</span> <span class="token constant">ID</span><span class="token operator">!</span> @eq<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">User</span> @find
  users<span class="token punctuation">:</span> <span class="token punctuation">[</span>User<span class="token operator">!</span><span class="token punctuation">]</span><span class="token operator">!</span> @paginate
  <span class="token function">article</span><span class="token punctuation">(</span><span class="token argument-name">id</span><span class="token punctuation">:</span> <span class="token constant">ID</span><span class="token operator">!</span> @eq<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">Article</span> @find
  articles<span class="token punctuation">:</span> <span class="token punctuation">[</span>Article<span class="token operator">!</span><span class="token punctuation">]</span><span class="token operator">!</span> @paginate
<span class="token punctuation">}</span>
</code></pre></div><p>You’ll see that we added an optional <code>relation</code> argument to the <code>@belongsTo</code> directive. This tells Lighthouse to use the <code>Articles</code> model’s <code>user</code> relationship and assign it to the <code>author</code> field.</p> <p>Now let’s query for a list of articles and grab their associated author:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span>
  <span class="token function">articles</span><span class="token punctuation">(</span><span class="token argument-name">count</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    paginatorInfo <span class="token punctuation">{</span>
      total
      hasMorePages
    <span class="token punctuation">}</span>
    data <span class="token punctuation">{</span>
      id
      title
      author <span class="token punctuation">{</span>
        name
        email
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>And we should get the following from our server:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span>
  <span class="token string double-quoted-string">&quot;data&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string double-quoted-string">&quot;articles&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string double-quoted-string">&quot;paginatorInfo&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string double-quoted-string">&quot;total&quot;</span><span class="token punctuation">:</span> <span class="token number">55</span><span class="token punctuation">,</span>
        <span class="token string double-quoted-string">&quot;hasMorePages&quot;</span><span class="token punctuation">:</span> <span class="token constant boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string double-quoted-string">&quot;data&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;1&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Aut velit et temporibus ut et tempora sint.&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;author&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string double-quoted-string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Carolyn Powlowski&quot;</span><span class="token punctuation">,</span>
            <span class="token string double-quoted-string">&quot;email&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;graphql@test.com&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;2&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Voluptatem sed labore ea voluptas.&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;author&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string double-quoted-string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Carolyn Powlowski&quot;</span><span class="token punctuation">,</span>
            <span class="token string double-quoted-string">&quot;email&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;graphql@test.com&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="graphql-mutation"><a href="#graphql-mutation" class="header-anchor">#</a> GraphQL Mutation</h2> <p>Now that we can query our data, let’s create some mutations to create some new users and articles. We’ll start with our user model:</p> <div class="language-php extra-class"><pre class="language-php"><code>type Mutation <span class="token punctuation">{</span>
  <span class="token function">createUser</span><span class="token punctuation">(</span>
    <span class="token argument-name">name</span><span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span>
    email<span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span> @<span class="token function">rules</span><span class="token punctuation">(</span><span class="token argument-name">apply</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;email&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;unique:users&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    password<span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span> @bcrypt @<span class="token function">rules</span><span class="token punctuation">(</span><span class="token argument-name">apply</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;min:6&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">User</span> @create
<span class="token punctuation">}</span>
</code></pre></div><p>Now let’s break this schema definition down. We’ve created a mutation called <code>createUser</code> which takes three arguments (<code>name</code>, <code>email</code>, and <code>password</code>). We’ve applied the <code>@rules</code> directive to both our <code>email</code> and <code>password</code> arguments. This may look a bit familiar because it’s similar to the <a href="https://laravel.com/docs/5.8/validation#quick-writing-the-validation-logic" target="_blank" rel="noopener noreferrer">validation logic<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> Laravel provides for its controllers.</p> <p>Next, we’ve attached the <code>@bcrypt</code> directive to our <code>password</code> field. This will encrypt the password before it is passed to the newly created model.</p> <p>Finally, to help us create new models, Lighthouse provides a <code>@create</code> schema directive which will take the arguments we defined and create a new model. Performing the same logic in a Controller would look like the following:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Controllers</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Http<span class="token punctuation">\</span>Request</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">UserController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Create a new user.
     *
     * @param \Illuminate\Http\Request $request
     * @return \Illuminate\Http\Response
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">store</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">'email'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'email'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'unique:users'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'password'</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'min:6'</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token class-name class-name-fully-qualified static-context"><span class="token punctuation">\</span>App<span class="token punctuation">\</span>User</span><span class="token operator">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token function">response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span> <span class="token operator">=&gt;</span> <span class="token variable">$user</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now that we have our createUser mutation field set up, let’s go ahead and run it in GraphQL Playground with the following:</p> <div class="language-php extra-class"><pre class="language-php"><code>mutation <span class="token punctuation">{</span>
  <span class="token function">createUser</span><span class="token punctuation">(</span>
    <span class="token argument-name">name</span><span class="token punctuation">:</span><span class="token string double-quoted-string">&quot;John Doe&quot;</span>
    email<span class="token punctuation">:</span><span class="token string double-quoted-string">&quot;john.doe@example.com&quot;</span>
    password<span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;secret&quot;</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    id
    name
    email
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>We should get the following output:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span>
  <span class="token string double-quoted-string">&quot;data&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string double-quoted-string">&quot;createUser&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;12&quot;</span><span class="token punctuation">,</span>
      <span class="token string double-quoted-string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;John Doe&quot;</span><span class="token punctuation">,</span>
      <span class="token string double-quoted-string">&quot;email&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;john.doe@example.com&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="graphql-authentication-and-authorization"><a href="#graphql-authentication-and-authorization" class="header-anchor">#</a> GraphQL Authentication and Authorization</h3> <p>Since we need to add a <code>user_id</code> to our <code>Article</code> models, now would be a great time to go over authentication and authorization in GraphQL/Lighthouse.</p> <p><a href="https://uploads.toptal.io/blog/image/129745/toptal-blog-image-1557973309887-185e6faa8b16526a9ad524325794d3d7.png" target="_blank" rel="noopener noreferrer"><img src="https://assets.toptal.io/images?url=https://uploads.toptal.io/blog/image/129745/toptal-blog-image-1557973309887-185e6faa8b16526a9ad524325794d3d7.png" alt="image alt text"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>To authenticate a user, we need to provide them with an <code>api_token</code>, so let’s create a mutation to handle that and we’ll add the <code>@field</code> directive to point Lighthouse to a custom resolver which will handle the logic. We set the resolver in the same pattern as <a href="https://laravel.com/docs/5.8/controllers#basic-controllers" target="_blank" rel="noopener noreferrer">defining a controller<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> in Laravel using the <code>resolver</code> argument.</p> <p>With the <code>@field</code> directive defined below, we’re telling Lighthouse when the <code>login</code> mutation is run, use the <code>createToken</code> method on our <code>App\GraphQL\Mutations\AuthMutator</code> class:</p> <div class="language-php extra-class"><pre class="language-php"><code>type Mutation <span class="token punctuation">{</span>
  <span class="token comment"># ...</span>

  <span class="token function">login</span><span class="token punctuation">(</span>
    <span class="token argument-name">email</span><span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span> 
    password<span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span>
  <span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">String</span> @<span class="token function">field</span><span class="token punctuation">(</span><span class="token argument-name">resolver</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;AuthMutator@resolve&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>Note:</strong> <em>You do not need to include the entire namespace here. In the <code>lighthouse.php</code> config file you’ll see we have the namespace defined for our mutations set as <code>App\\GraphQL\\Mutations</code> already—however, you could use the full namespace if you prefer.</em></p> <p>Let’s use Lighthouse’s generator to create the new mutator class:</p> <div class="language-php extra-class"><pre class="language-php"><code>$ php artisan lighthouse<span class="token punctuation">:</span>mutation AuthMutator
</code></pre></div><p>Next, let’s update our resolver function like so:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>GraphQL<span class="token punctuation">\</span>Mutations</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Arr</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Str</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Facades<span class="token punctuation">\</span>Auth</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">GraphQL<span class="token punctuation">\</span>Type<span class="token punctuation">\</span>Definition<span class="token punctuation">\</span>ResolveInfo</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Nuwave<span class="token punctuation">\</span>Lighthouse<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>GraphQLContext</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">AuthMutator</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Return a value for the field.
     *
     * @param  null  $rootValue Usually contains the result returned from the parent field. In this case, it is always `null`.
     * @param  mixed[]  $args The arguments that were passed into the field.
     * @param  \Nuwave\Lighthouse\Support\Contracts\GraphQLContext  $context Arbitrary data that is shared between all fields of a single query.
     * @param  \GraphQL\Type\Definition\ResolveInfo  $resolveInfo Information about the query itself, such as the execution state, the field name, path to the field from the root, and more.
     * @return mixed
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">resolve</span><span class="token punctuation">(</span><span class="token variable">$rootValue</span><span class="token punctuation">,</span> <span class="token keyword type-hint">array</span> <span class="token variable">$args</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">GraphQLContext</span> <span class="token variable">$context</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">ResolveInfo</span> <span class="token variable">$resolveInfo</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$credentials</span> <span class="token operator">=</span> <span class="token class-name static-context">Arr</span><span class="token operator">::</span><span class="token function">only</span><span class="token punctuation">(</span><span class="token variable">$args</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'email'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name static-context">Auth</span><span class="token operator">::</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token variable">$credentials</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$token</span> <span class="token operator">=</span> <span class="token class-name static-context">Str</span><span class="token operator">::</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">auth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token property">api_token</span> <span class="token operator">=</span> <span class="token variable">$token</span><span class="token punctuation">;</span>
            <span class="token variable">$user</span><span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">return</span> <span class="token variable">$token</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token constant">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now that we have our resolver set up, let’s test it out and try to obtain an API token using the following mutation in GraphQL Playground:</p> <div class="language-php extra-class"><pre class="language-php"><code>mutation <span class="token punctuation">{</span>
  <span class="token function">login</span><span class="token punctuation">(</span><span class="token argument-name">email</span><span class="token punctuation">:</span><span class="token string double-quoted-string">&quot;graphql@test.com&quot;</span><span class="token punctuation">,</span> <span class="token argument-name">password</span><span class="token punctuation">:</span><span class="token string double-quoted-string">&quot;secret&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>We should get a token sent back to us like so:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span>
  <span class="token string double-quoted-string">&quot;data&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string double-quoted-string">&quot;login&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;VJCz1DCpmdvB9WatqvWbXBP2RN8geZQlrQatUnWIBJCdbAyTl3UsdOuio3VE&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Note:</strong> <em>Be sure to copy the token returned from the login mutation so we can use it later.</em></p> <p>Next, let’s add a query field which will return the authenticated user to make sure our logic works. We’ll add a field called <code>me</code> and use Lighthouse’s <code>@auth</code> directive to return the currently authenticated user. We’ll also set the <code>guard</code> argument equal to <code>api</code> since that is how we will authenticate the user.</p> <div class="language-php extra-class"><pre class="language-php"><code>type Query <span class="token punctuation">{</span>
  <span class="token comment"># ...</span>
  me<span class="token punctuation">:</span> User @<span class="token function">auth</span><span class="token punctuation">(</span><span class="token argument-name">guard</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;api&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now let’s run the query. In GraphQL Playground, you can set your request headers by double clicking the “Http Headers” tab at the bottom. We add headers with a JSON object, so to add a bearer token to each request, you would add the following:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span>
  <span class="token string double-quoted-string">&quot;Authorization&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Bearer VJCz1DCpmdvB9WatqvWbXBP2RN8geZQlrQatUnWIBJCdbAyTl3UsdOuio3VE&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Note:</strong> <em>Replace the bearer token with the token you received when running the <strong>login</strong> query.</em></p> <p>Now let’s run the <code>me</code> query:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span>
  me <span class="token punctuation">{</span>
    email
    articles <span class="token punctuation">{</span>
      id
      title
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>We should get output that looks like this:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span>
  <span class="token string double-quoted-string">&quot;data&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string double-quoted-string">&quot;me&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string double-quoted-string">&quot;email&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;graphql@test.com&quot;</span><span class="token punctuation">,</span>
      <span class="token string double-quoted-string">&quot;articles&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;1&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Rerum perspiciatis et quos occaecati exercitationem.&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;2&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Placeat quia cumque laudantium optio voluptatem sed qui.&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;3&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Optio voluptatem et itaque sit animi.&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;4&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Excepturi in ad qui dolor ad perspiciatis adipisci.&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;5&quot;</span><span class="token punctuation">,</span>
          <span class="token string double-quoted-string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Qui nemo blanditiis sed fugit consequatur.&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="middleware"><a href="#middleware" class="header-anchor">#</a> Middleware</h3> <p>Now that we know our authentication is working properly, let’s create our last mutation to create an article using the currently authenticated user. We’ll use the <code>@field</code> directive to point Lighthouse to our resolver and we’ll also include a <code>@middleware</code> directive to ensure that a user is logged in.</p> <div class="language-php extra-class"><pre class="language-php"><code>type Mutation <span class="token punctuation">{</span>
  <span class="token comment"># ...</span>

  <span class="token function">createArticle</span><span class="token punctuation">(</span><span class="token argument-name">title</span><span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span><span class="token punctuation">,</span> <span class="token argument-name">content</span><span class="token punctuation">:</span> <span class="token keyword type-declaration">String</span><span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">Article</span> 
    @<span class="token function">field</span><span class="token punctuation">(</span><span class="token argument-name">resolver</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;ArticleMutator@create&quot;</span><span class="token punctuation">)</span>
    @<span class="token function">middleware</span><span class="token punctuation">(</span><span class="token argument-name">checks</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;auth:api&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>First, let’s generate a mutation class:</p> <div class="language-php extra-class"><pre class="language-php"><code>$ php artisan lighthouse<span class="token punctuation">:</span>mutation ArticleMutator
</code></pre></div><p>Next, let’s update the mutator with the following logic:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>GraphQL<span class="token punctuation">\</span>Mutations</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Nuwave<span class="token punctuation">\</span>Lighthouse<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>GraphQLContext</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">ArticleMutator</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * Return a value for the field.
     *
     * @param  null  $rootValue
     * @param  mixed[]  $args
     * @param  \Nuwave\Lighthouse\Support\Contracts\GraphQLContext  $context 
     * @return mixed
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">create</span><span class="token punctuation">(</span><span class="token variable">$rootValue</span><span class="token punctuation">,</span> <span class="token keyword type-hint">array</span> <span class="token variable">$args</span><span class="token punctuation">,</span> <span class="token class-name type-declaration">GraphQLContext</span> <span class="token variable">$context</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$article</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>App<span class="token punctuation">\</span>Article</span><span class="token punctuation">(</span><span class="token variable">$args</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$context</span><span class="token operator">-&gt;</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">articles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token variable">$article</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token variable">$article</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Note:</strong> <em>We renamed the default <code>resolve</code> function to <code>create</code>. You don’t need to create a new class for every resolver. Instead, you can group logic together if it makes more sense.</em></p> <p>Finally, let’s run our new mutation and check the output. Be sure to keep the <code>Authorization</code> header from our previous query in the “HTTP Headers” tab:</p> <div class="language-php extra-class"><pre class="language-php"><code>mutation <span class="token punctuation">{</span>
  <span class="token function">createArticle</span><span class="token punctuation">(</span>
    <span class="token argument-name">title</span><span class="token punctuation">:</span><span class="token string double-quoted-string">&quot;Building a GraphQL Server with Laravel&quot;</span>
    content<span class="token punctuation">:</span><span class="token string double-quoted-string">&quot;In case you're not currently familiar with it, GraphQL is a query language used to interact with your API...&quot;</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    id
    author <span class="token punctuation">{</span>
      id
      email
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>We should get the following output:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">{</span>
  <span class="token string double-quoted-string">&quot;data&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string double-quoted-string">&quot;createArticle&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;56&quot;</span><span class="token punctuation">,</span>
      <span class="token string double-quoted-string">&quot;author&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string double-quoted-string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;1&quot;</span><span class="token punctuation">,</span>
        <span class="token string double-quoted-string">&quot;email&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;graphql@test.com&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="wrapping-up"><a href="#wrapping-up" class="header-anchor">#</a> Wrapping Up</h2> <p>To recap, we’ve leveraged Lighthouse to create a GraphQL server for our Laravel project. We made use of some built in schema directives, created queries and mutations, and handled authorization and Authentication.</p> <p>Lighthouse allows you to do much more (such as allowing you to create your own <a href="https://lighthouse-php.com/5/api-reference/directives.html" target="_blank" rel="noopener noreferrer">custom schema directives<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) but for the purposes of this article we stuck to the basics and we were able to get a GraphQL server up and running with fairly little boilerplate.</p> <p>The next time you need to set up an API for a mobile or single-page application, be sure to consider <a href="https://www.toptal.com/graphql" target="_blank" rel="noopener noreferrer">GraphQL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> as a way to query your data!</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/doc_notes/assets/js/app.d7b7570d.js" defer></script><script src="/doc_notes/assets/js/2.733019b2.js" defer></script><script src="/doc_notes/assets/js/230.043a91e9.js" defer></script>
  </body>
</html>
